<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-item/paper-icon-item.html">
<link rel="import" href="../paper-item/paper-item-body.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../iron-icons/iron-icons.html">
<link rel="import" href="../iron-icons/communication-icons.html">
<link rel="import" href="../polymerfire/firebase-document.html">

<dom-module id="node-manager">
    <template>
        <firebase-document
            path="[[fbnode]]"
            data="{{value}}">
        </firebase-document>
        <div role="listbox">
            <template is="dom-repeat" items="[[nodekeys]]">
                <paper-icon-item>
                    <div class="avatar blue" item-icon></div>
                    <paper-item-body two-line>
                        <div>[[item]]</div>
                        <div secondary>Some Description (for future)</div>
                    </paper-item-body>
                    <paper-icon-button
                        icon="communication:call-split"
                        alt="fork this!">
                    </paper-icon-button>
                    <paper-icon-button
                        icon="icons:open-in-browser"
                        alt="view this!"
                        data-item$="[[item]]"
                        on-click="_handleOpen">
                </paper-icon-button>
                </paper-icon-item>
            </template>
        </div>
    </template>
    <script>
        Polymer({
            is: 'node-manager',

            properties: {
                fbnode: {
                    type: String,
                    value: 'template',
                    reflectToAttribute: true,
                    notify: true
                },

                value: {
                    type: Object,
                    reflectToAttribute: false,
                    notify: true,
                    value : {
                              "abcd" : {
                                "demo-image-el-0" : {
                                  "name" : "demo-image-el",
                                  "properties" : [ {
                                    "name" : "componentProperties",
                                    "value" : [ {
                                      "description" : "The image src",
                                      "name" : "src",
                                      "type" : "text",
                                      "value" : "http://prateekjadhwani.github.io/images/logo.png"
                                    } ]
                                  }, {
                                    "name" : "display",
                                    "value" : [ {
                                      "description" : "The start column location of this component",
                                      "name" : "gridColumnStart",
                                      "type" : "text",
                                      "value" : "1"
                                    }, {
                                      "description" : "The end column location of this component",
                                      "name" : "gridColumnEnd",
                                      "type" : "text",
                                      "value" : "12"
                                    }, {
                                      "description" : "The start row location of this component",
                                      "name" : "gridRowStart",
                                      "type" : "text",
                                      "value" : ""
                                    }, {
                                      "description" : "The end row location of this component",
                                      "name" : "gridRowEnd",
                                      "type" : "text",
                                      "value" : ""
                                    } ]
                                  } ]
                                },
                                "demo-text-el-0" : {
                                  "name" : "demo-text-el",
                                  "properties" : [ {
                                    "name" : "componentProperties",
                                    "value" : [ {
                                      "description" : "The alignment of the text",
                                      "name" : "align",
                                      "options" : [ "left", "center", "right" ],
                                      "type" : "dropdown",
                                      "value" : 0
                                    } ]
                                  }, {
                                    "name" : "display",
                                    "value" : [ {
                                      "description" : "The start column location of this component",
                                      "name" : "gridColumnStart",
                                      "type" : "text",
                                      "value" : "1"
                                    }, {
                                      "description" : "The end column location of this component",
                                      "name" : "gridColumnEnd",
                                      "type" : "text",
                                      "value" : "12"
                                    }, {
                                      "description" : "The start row location of this component",
                                      "name" : "gridRowStart",
                                      "type" : "text",
                                      "value" : ""
                                    }, {
                                      "description" : "The end row location of this component",
                                      "name" : "gridRowEnd",
                                      "type" : "text",
                                      "value" : ""
                                    } ]
                                  } ]
                                },
                                "demo-text-nested-el-0" : {
                                  "name" : "demo-text-nested-el",
                                  "properties" : [ {
                                    "name" : "componentProperties",
                                    "value" : [ {
                                      "description" : "The alignment of the text",
                                      "name" : "align",
                                      "options" : [ "left", "center", "right" ],
                                      "type" : "dropdown",
                                      "value" : 0
                                    } ]
                                  }, {
                                    "name" : "display",
                                    "value" : [ {
                                      "description" : "The start column location of this component",
                                      "name" : "gridColumnStart",
                                      "type" : "text",
                                      "value" : "1"
                                    }, {
                                      "description" : "The end column location of this component",
                                      "name" : "gridColumnEnd",
                                      "type" : "text",
                                      "value" : "12"
                                    }, {
                                      "description" : "The start row location of this component",
                                      "name" : "gridRowStart",
                                      "type" : "text",
                                      "value" : ""
                                    }, {
                                      "description" : "The end row location of this component",
                                      "name" : "gridRowEnd",
                                      "type" : "text",
                                      "value" : ""
                                    } ]
                                  } ]
                                }
                              },
                              "abcd1" : {
                                "demo-text-el-0" : {
                                  "name" : "demo-text-el",
                                  "properties" : [ {
                                    "name" : "componentProperties",
                                    "value" : [ {
                                      "description" : "The alignment of the text",
                                      "name" : "align",
                                      "options" : [ "left", "center", "right" ],
                                      "type" : "dropdown",
                                      "value" : 0
                                    } ]
                                  }, {
                                    "name" : "display",
                                    "value" : [ {
                                      "description" : "The start column location of this component",
                                      "name" : "gridColumnStart",
                                      "type" : "text",
                                      "value" : "1"
                                    }, {
                                      "description" : "The end column location of this component",
                                      "name" : "gridColumnEnd",
                                      "type" : "text",
                                      "value" : "12"
                                    }, {
                                      "description" : "The start row location of this component",
                                      "name" : "gridRowStart",
                                      "type" : "text",
                                      "value" : ""
                                    }, {
                                      "description" : "The end row location of this component",
                                      "name" : "gridRowEnd",
                                      "type" : "text",
                                      "value" : ""
                                    } ]
                                  } ]
                                },
                                "demo-text-el-1" : {
                                  "name" : "demo-text-el",
                                  "properties" : [ {
                                    "name" : "componentProperties",
                                    "value" : [ {
                                      "description" : "The alignment of the text",
                                      "name" : "align",
                                      "options" : [ "left", "center", "right" ],
                                      "type" : "dropdown",
                                      "value" : 0
                                    } ]
                                  }, {
                                    "name" : "display",
                                    "value" : [ {
                                      "description" : "The start column location of this component",
                                      "name" : "gridColumnStart",
                                      "type" : "text",
                                      "value" : "1"
                                    }, {
                                      "description" : "The end column location of this component",
                                      "name" : "gridColumnEnd",
                                      "type" : "text",
                                      "value" : "12"
                                    }, {
                                      "description" : "The start row location of this component",
                                      "name" : "gridRowStart",
                                      "type" : "text",
                                      "value" : ""
                                    }, {
                                      "description" : "The end row location of this component",
                                      "name" : "gridRowEnd",
                                      "type" : "text",
                                      "value" : ""
                                    } ]
                                  } ]
                                },
                                "demo-text-nested-el-0" : {
                                  "components" : {
                                    "css-grid-1" : {
                                      "demo-text-el-0" : {
                                        "name" : "demo-text-el",
                                        "properties" : [ {
                                          "name" : "componentProperties",
                                          "value" : [ {
                                            "description" : "The alignment of the text",
                                            "name" : "align",
                                            "options" : [ "left", "center", "right" ],
                                            "type" : "dropdown",
                                            "value" : "right"
                                          } ]
                                        }, {
                                          "name" : "display",
                                          "value" : [ {
                                            "description" : "The start column location of this component",
                                            "name" : "gridColumnStart",
                                            "type" : "text",
                                            "value" : "1"
                                          }, {
                                            "description" : "The end column location of this component",
                                            "name" : "gridColumnEnd",
                                            "type" : "text",
                                            "value" : "12"
                                          }, {
                                            "description" : "The start row location of this component",
                                            "name" : "gridRowStart",
                                            "type" : "text",
                                            "value" : ""
                                          }, {
                                            "description" : "The end row location of this component",
                                            "name" : "gridRowEnd",
                                            "type" : "text",
                                            "value" : ""
                                          } ]
                                        } ]
                                      }
                                    }
                                  },
                                  "name" : "demo-text-nested-el",
                                  "properties" : [ {
                                    "name" : "componentProperties",
                                    "value" : [ {
                                      "description" : "The alignment of the text",
                                      "name" : "align",
                                      "options" : [ "left", "center", "right" ],
                                      "type" : "dropdown",
                                      "value" : "right"
                                    } ]
                                  }, {
                                    "name" : "display",
                                    "value" : [ {
                                      "description" : "The start column location of this component",
                                      "name" : "gridColumnStart",
                                      "type" : "text",
                                      "value" : "1"
                                    }, {
                                      "description" : "The end column location of this component",
                                      "name" : "gridColumnEnd",
                                      "type" : "text",
                                      "value" : "12"
                                    }, {
                                      "description" : "The start row location of this component",
                                      "name" : "gridRowStart",
                                      "type" : "text",
                                      "value" : ""
                                    }, {
                                      "description" : "The end row location of this component",
                                      "name" : "gridRowEnd",
                                      "type" : "text",
                                      "value" : ""
                                    } ]
                                  } ]
                                },
                                "pull-to-action-0" : {
                                  "name" : "pull-to-action",
                                  "properties" : {
                                    "name" : "componentProperties",
                                    "value" : [ {
                                      "description" : "A callback function that for which action should be performed",
                                      "name" : "action",
                                      "type" : "text",
                                      "value" : "alert(\"You need to set the action attribute\")"
                                    }, {
                                      "description" : "the container element (if identifing with id start with # and . for class)",
                                      "name" : "container",
                                      "type" : "text",
                                      "value" : "body"
                                    }, {
                                      "description" : "How far the user has to drag the screen",
                                      "name" : "distance",
                                      "type" : "number",
                                      "value" : 100
                                    } ]
                                  }
                                }
                              },
                              "avfd" : {
                                "demo-text-nested-el-0" : {
                                  "name" : "demo-text-nested-el",
                                  "properties" : [ {
                                    "name" : "componentProperties",
                                    "value" : [ {
                                      "description" : "The alignment of the text",
                                      "name" : "align",
                                      "options" : [ "left", "center", "right" ],
                                      "type" : "dropdown",
                                      "value" : 0
                                    } ]
                                  }, {
                                    "name" : "display",
                                    "value" : [ {
                                      "description" : "The start column location of this component",
                                      "name" : "gridColumnStart",
                                      "type" : "text",
                                      "value" : "1"
                                    }, {
                                      "description" : "The end column location of this component",
                                      "name" : "gridColumnEnd",
                                      "type" : "text",
                                      "value" : "12"
                                    }, {
                                      "description" : "The start row location of this component",
                                      "name" : "gridRowStart",
                                      "type" : "text",
                                      "value" : ""
                                    }, {
                                      "description" : "The end row location of this component",
                                      "name" : "gridRowEnd",
                                      "type" : "text",
                                      "value" : ""
                                    } ]
                                  } ]
                                }
                              },
                              "avfg" : {
                                "demo-text-nested-el-0" : {
                                  "name" : "demo-text-nested-el",
                                  "properties" : [ {
                                    "name" : "componentProperties",
                                    "value" : [ {
                                      "description" : "The alignment of the text",
                                      "name" : "align",
                                      "options" : [ "left", "center", "right" ],
                                      "type" : "dropdown",
                                      "value" : 0
                                    } ]
                                  }, {
                                    "name" : "display",
                                    "value" : [ {
                                      "description" : "The start column location of this component",
                                      "name" : "gridColumnStart",
                                      "type" : "text",
                                      "value" : "1"
                                    }, {
                                      "description" : "The end column location of this component",
                                      "name" : "gridColumnEnd",
                                      "type" : "text",
                                      "value" : "12"
                                    }, {
                                      "description" : "The start row location of this component",
                                      "name" : "gridRowStart",
                                      "type" : "text",
                                      "value" : ""
                                    }, {
                                      "description" : "The end row location of this component",
                                      "name" : "gridRowEnd",
                                      "type" : "text",
                                      "value" : ""
                                    } ]
                                  } ]
                                }
                              },
                              "proct1" : {
                                "demo-image-el-0" : {
                                  "name" : "demo-image-el",
                                  "properties" : [ {
                                    "name" : "componentProperties",
                                    "value" : [ {
                                      "description" : "The image src",
                                      "name" : "src",
                                      "type" : "text",
                                      "value" : "http://prateekjadhwani.github.io/images/logo.png"
                                    } ]
                                  }, {
                                    "name" : "display",
                                    "value" : [ {
                                      "description" : "The start column location of this component",
                                      "name" : "gridColumnStart",
                                      "type" : "text",
                                      "value" : "1"
                                    }, {
                                      "description" : "The end column location of this component",
                                      "name" : "gridColumnEnd",
                                      "type" : "text",
                                      "value" : "12"
                                    }, {
                                      "description" : "The start row location of this component",
                                      "name" : "gridRowStart",
                                      "type" : "text",
                                      "value" : ""
                                    }, {
                                      "description" : "The end row location of this component",
                                      "name" : "gridRowEnd",
                                      "type" : "text",
                                      "value" : ""
                                    } ]
                                  } ]
                                },
                                "demo-text-el-0" : {
                                  "name" : "demo-text-el",
                                  "properties" : [ {
                                    "name" : "componentProperties",
                                    "value" : [ {
                                      "description" : "The alignment of the text",
                                      "name" : "align",
                                      "options" : [ "left", "center", "right" ],
                                      "type" : "dropdown",
                                      "value" : 0
                                    } ]
                                  }, {
                                    "name" : "display",
                                    "value" : [ {
                                      "description" : "The start column location of this component",
                                      "name" : "gridColumnStart",
                                      "type" : "text",
                                      "value" : "1"
                                    }, {
                                      "description" : "The end column location of this component",
                                      "name" : "gridColumnEnd",
                                      "type" : "text",
                                      "value" : "12"
                                    }, {
                                      "description" : "The start row location of this component",
                                      "name" : "gridRowStart",
                                      "type" : "text",
                                      "value" : ""
                                    }, {
                                      "description" : "The end row location of this component",
                                      "name" : "gridRowEnd",
                                      "type" : "text",
                                      "value" : ""
                                    } ]
                                  } ]
                                },
                                "demo-text-el-1" : {
                                  "name" : "demo-text-el",
                                  "properties" : [ {
                                    "name" : "componentProperties",
                                    "value" : [ {
                                      "description" : "The alignment of the text",
                                      "name" : "align",
                                      "options" : [ "left", "center", "right" ],
                                      "type" : "dropdown",
                                      "value" : 0
                                    } ]
                                  }, {
                                    "name" : "display",
                                    "value" : [ {
                                      "description" : "The start column location of this component",
                                      "name" : "gridColumnStart",
                                      "type" : "text",
                                      "value" : "1"
                                    }, {
                                      "description" : "The end column location of this component",
                                      "name" : "gridColumnEnd",
                                      "type" : "text",
                                      "value" : "12"
                                    }, {
                                      "description" : "The start row location of this component",
                                      "name" : "gridRowStart",
                                      "type" : "text",
                                      "value" : ""
                                    }, {
                                      "description" : "The end row location of this component",
                                      "name" : "gridRowEnd",
                                      "type" : "text",
                                      "value" : ""
                                    } ]
                                  } ]
                                },
                                "demo-text-nested-el-0" : {
                                  "components" : {
                                    "css-grid-1" : {
                                      "demo-text-el-0" : {
                                        "name" : "demo-text-el",
                                        "properties" : [ {
                                          "name" : "componentProperties",
                                          "value" : [ {
                                            "description" : "The alignment of the text",
                                            "name" : "align",
                                            "options" : [ "left", "center", "right" ],
                                            "type" : "dropdown",
                                            "value" : 0
                                          } ]
                                        }, {
                                          "name" : "display",
                                          "value" : [ {
                                            "description" : "The start column location of this component",
                                            "name" : "gridColumnStart",
                                            "type" : "text",
                                            "value" : "1"
                                          }, {
                                            "description" : "The end column location of this component",
                                            "name" : "gridColumnEnd",
                                            "type" : "text",
                                            "value" : "12"
                                          }, {
                                            "description" : "The start row location of this component",
                                            "name" : "gridRowStart",
                                            "type" : "text",
                                            "value" : ""
                                          }, {
                                            "description" : "The end row location of this component",
                                            "name" : "gridRowEnd",
                                            "type" : "text",
                                            "value" : ""
                                          } ]
                                        } ]
                                      }
                                    }
                                  },
                                  "name" : "demo-text-nested-el",
                                  "properties" : [ {
                                    "name" : "componentProperties",
                                    "value" : [ {
                                      "description" : "The alignment of the text",
                                      "name" : "align",
                                      "options" : [ "left", "center", "right" ],
                                      "type" : "dropdown",
                                      "value" : 0
                                    } ]
                                  }, {
                                    "name" : "display",
                                    "value" : [ {
                                      "description" : "The start column location of this component",
                                      "name" : "gridColumnStart",
                                      "type" : "text",
                                      "value" : "1"
                                    }, {
                                      "description" : "The end column location of this component",
                                      "name" : "gridColumnEnd",
                                      "type" : "text",
                                      "value" : "12"
                                    }, {
                                      "description" : "The start row location of this component",
                                      "name" : "gridRowStart",
                                      "type" : "text",
                                      "value" : ""
                                    }, {
                                      "description" : "The end row location of this component",
                                      "name" : "gridRowEnd",
                                      "type" : "text",
                                      "value" : ""
                                    } ]
                                  } ]
                                }
                              },
                              "temp-template" : {
                                "demo-image-el-0" : {
                                  "name" : "demo-image-el",
                                  "properties" : [ {
                                    "name" : "componentProperties",
                                    "value" : [ {
                                      "description" : "The image src",
                                      "name" : "src",
                                      "type" : "text",
                                      "value" : "http://prateekjadhwani.github.io/images/logo.png"
                                    } ]
                                  }, {
                                    "name" : "display",
                                    "value" : [ {
                                      "description" : "The start column location of this component",
                                      "name" : "gridColumnStart",
                                      "type" : "text",
                                      "value" : "1"
                                    }, {
                                      "description" : "The end column location of this component",
                                      "name" : "gridColumnEnd",
                                      "type" : "text",
                                      "value" : "12"
                                    }, {
                                      "description" : "The start row location of this component",
                                      "name" : "gridRowStart",
                                      "type" : "text",
                                      "value" : ""
                                    }, {
                                      "description" : "The end row location of this component",
                                      "name" : "gridRowEnd",
                                      "type" : "text",
                                      "value" : ""
                                    } ]
                                  } ]
                                },
                                "demo-text-el-0" : {
                                  "name" : "demo-text-el",
                                  "properties" : [ {
                                    "name" : "componentProperties",
                                    "value" : [ {
                                      "description" : "The alignment of the text",
                                      "name" : "align",
                                      "options" : [ "left", "center", "right" ],
                                      "type" : "dropdown",
                                      "value" : 0
                                    } ]
                                  }, {
                                    "name" : "display",
                                    "value" : [ {
                                      "description" : "The start column location of this component",
                                      "name" : "gridColumnStart",
                                      "type" : "text",
                                      "value" : "1"
                                    }, {
                                      "description" : "The end column location of this component",
                                      "name" : "gridColumnEnd",
                                      "type" : "text",
                                      "value" : "12"
                                    }, {
                                      "description" : "The start row location of this component",
                                      "name" : "gridRowStart",
                                      "type" : "text",
                                      "value" : ""
                                    }, {
                                      "description" : "The end row location of this component",
                                      "name" : "gridRowEnd",
                                      "type" : "text",
                                      "value" : ""
                                    } ]
                                  } ]
                                },
                                "demo-text-el-1" : {
                                  "name" : "demo-text-el",
                                  "properties" : [ {
                                    "name" : "componentProperties",
                                    "value" : [ {
                                      "description" : "The alignment of the text",
                                      "name" : "align",
                                      "options" : [ "left", "center", "right" ],
                                      "type" : "dropdown",
                                      "value" : 0
                                    } ]
                                  }, {
                                    "name" : "display",
                                    "value" : [ {
                                      "description" : "The start column location of this component",
                                      "name" : "gridColumnStart",
                                      "type" : "text",
                                      "value" : "1"
                                    }, {
                                      "description" : "The end column location of this component",
                                      "name" : "gridColumnEnd",
                                      "type" : "text",
                                      "value" : "12"
                                    }, {
                                      "description" : "The start row location of this component",
                                      "name" : "gridRowStart",
                                      "type" : "text",
                                      "value" : ""
                                    }, {
                                      "description" : "The end row location of this component",
                                      "name" : "gridRowEnd",
                                      "type" : "text",
                                      "value" : ""
                                    } ]
                                  } ]
                                }
                              }
                            }
                },

                nodekeys: {
                    type: Array,
                    reflectToAttribute: false,
                    notify: true,
                    value: [],
                    computed: '_getNodeKeys(value)'
                }
            },

            _getNodeKeys: function(value) {
                var keys = new Array();
                for(var prop in value) {
                    keys.push(prop);
                }
                return keys;
            },

            _handleOpen: function(e, detail) {
                this.set('route.path', '/' + this.template + '/edit/' + e.model.item);
            }
        })
    </script>
</dom-module>