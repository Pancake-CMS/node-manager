<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-item/paper-icon-item.html">
<link rel="import" href="../paper-item/paper-item-body.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../iron-icons/iron-icons.html">
<link rel="import" href="../iron-icons/communication-icons.html">
<link rel="import" href="../polymerfire/firebase-document.html">

<dom-module id="node-manager">
    <template>
        <firebase-document
            path="[[fbnode]]"
            data="{{value}}">
        </firebase-document>
        <div role="listbox">
            <template is="dom-repeat" items="[[nodekeys]]">
                <paper-icon-item>
                    <div class="avatar blue" item-icon></div>
                    <paper-item-body two-line>
                        <div>[[item]]</div>
                        <div secondary>Some Description (for future)</div>
                    </paper-item-body>
                    <paper-icon-button
                        icon="communication:call-split"
                        alt="fork this!">
                    </paper-icon-button>
                    <paper-icon-button
                        icon="icons:open-in-browser"
                        alt="view this!"
                        data-item$="[[item]]"
                        on-click="_handleOpen">
                </paper-icon-button>
                </paper-icon-item>
            </template>
        </div>
    </template>
    <script>
        Polymer({
            is: 'node-manager',

            properties: {
                fbnode: {
                    type: String,
                    reflectToAttribute: true,
                    notify: true
                },

                value: {
                    type: Object,
                    reflectToAttribute: false,
                    notify: true
                },

                nodekeys: {
                    type: Array,
                    reflectToAttribute: false,
                    notify: true,
                    value: [],
                    computed: '_getNodeKeys(value)'
                }
            },

            _getNodeKeys: function(value) {
                var keys = new Array();
                for(var prop in value) {
                    keys.push(prop);
                }
                return keys;
            },

            _handleOpen: function(e, detail) {
                this.set('route.path', '/' + this.fbnode + '/edit/' + e.model.item);
            }
        })
    </script>
</dom-module>